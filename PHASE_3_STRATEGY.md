# Phase 3 : Frontend Multi-Tenant - Strat√©gie

## ‚úÖ Fichiers cr√©√©s

1. `/app/frontend/src/contexts/TenantContext.js` - Contexte React pour le tenant
2. `/app/frontend/src/utils/api.js` - Helpers pour les API calls multi-tenant
3. `index.js` modifi√© pour inclure TenantProvider

## üéØ Modifications √† faire dans App.js

### 1. Importer useTenant
```javascript
import { useTenant } from './contexts/TenantContext';
```

### 2. Modifier AuthProvider pour utiliser le tenant
```javascript
const AuthProvider = ({ children }) => {
  const { tenantSlug } = useTenant();
  
  // Modifier login pour inclure tenantSlug
  const login = async (email, mot_de_passe) => {
    const response = await axios.post(
      `${API}/${tenantSlug}/auth/login`,
      { email, mot_de_passe }
    );
    // ...
  };
  
  // Modifier auth/me
  axios.get(`${API}/${tenantSlug}/auth/me`)
  // ...
};
```

### 3. Modifier TOUS les API calls dans App.js

**Pattern actuel :**
```javascript
axios.get(`${API}/users`)
axios.post(`${API}/types-garde`, data)
```

**Nouveau pattern :**
```javascript
import { apiGet, apiPost } from './utils/api';
const { tenantSlug } = useTenant();

apiGet(tenantSlug, '/users')
apiPost(tenantSlug, '/types-garde', data)
```

### 4. Composants √† modifier

Tous les composants qui font des appels API :
- Personnel
- Planning
- Formations
- Remplacements
- Disponibilites
- MonProfil
- Parametres
- Rapports
- ModuleEPI

**Strat√©gie :**
1. Importer `useTenant` dans chaque composant
2. R√©cup√©rer `tenantSlug` avec le hook
3. Remplacer tous les `axios` par les helpers `api.js`

## üìä Estimation

- **Nombre de composants √† modifier** : ~10
- **Nombre d'API calls √† migrer** : ~150-200
- **Temps estim√©** : 4-6 heures

## üöÄ Plan d'ex√©cution

### Phase 3A : Core (2-3h)
1. ‚úÖ Cr√©er TenantContext
2. ‚úÖ Cr√©er API helpers
3. ‚úÖ Modifier index.js
4. ‚è≥ Modifier AuthProvider dans App.js
5. ‚è≥ Modifier le composant Login
6. ‚è≥ Modifier les API calls principaux dans App.js

### Phase 3B : Composants (2-3h)
7. Modifier Personnel
8. Modifier Planning
9. Modifier Formations
10. Modifier autres composants

### Phase 3C : Super-Admin (1-2h)
11. Cr√©er interface Super-Admin
12. Login super-admin
13. Gestion des tenants

## üß™ Tests apr√®s Phase 3

1. Login Shefford ‚Üí `http://localhost:3000/shefford`
2. Voir que les donn√©es sont filtr√©es par tenant
3. Login Bromont (apr√®s cr√©ation) ‚Üí `http://localhost:3000/bromont`
4. V√©rifier isolation compl√®te
5. Super-admin ‚Üí `http://localhost:3000/admin`

## ‚ö†Ô∏è Points critiques

1. **Tous les API calls DOIVENT** inclure le tenantSlug
2. **Le token JWT** contient d√©j√† le tenant_id
3. **Les routes** doivent correspondre au tenant de l'URL
4. **Navigation** doit pr√©server le tenant dans l'URL

## üéØ Objectif Phase 3

**Frontend compl√®tement multi-tenant avec :**
- ‚úÖ D√©tection automatique du tenant
- ‚úÖ API calls tenant-aware
- ‚úÖ Isolation visuelle des donn√©es
- ‚úÖ Interface Super-Admin
- ‚úÖ Support de multiples casernes

---

**Phase 3A en cours...**
